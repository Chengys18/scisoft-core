/*-
 * Copyright 2015 Diamond Light Source Ltd.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 */

package uk.ac.diamond.scisoft.xpdf;

import java.util.HashMap;
import java.util.Map;

public final class XPDFMassAttenuation {

	// I15-1 only produces a closed set of energies, here listed in eV, to
	// avoid fractional values and floating point keys
	static int[] fixedEnergies = {40000, 63500, 76600};
	
	private XPDFMassAttenuation() {
	}
	
	public static double get(int energy, int z) {
		if (muMaps.size() < fixedEnergies.length) {
			muMaps.put(fixedEnergies[0], muForty);
			muMaps.put(fixedEnergies[1], muSixtyThree);
			muMaps.put(fixedEnergies[2], muSeventySix);
		}

		if (!muMaps.containsKey(energy)) {
			// Throw an exception?
		}
		return muMaps.get(energy)[z-1];	
	}
	
	static double[] muForty = {
			0.345818316736,
			0.176310728519,
			0.155060824191,
			0.163965737028,
			0.17936078392,
			0.207638796061,
			0.228757067011,
			0.258513894445,
			0.282810868286,
			0.347248184405,
			0.3969047987,
			0.488040019904,
			0.568432761036,
			0.701008995889,
			0.809536528725,
			0.987232356624,
			1.11660181189,
			1.22811110745,
			1.54084198133,
			1.83045883207,
			1.96951061344,
			2.21277235822,
			2.4722682146,
			2.85564135653,
			3.16935503853,
			3.62922277086,
			3.98034498388,
			4.59981256134,
			4.86170484324,
			5.3841023601,
			5.72571176514,
			6.20643044249,
			6.76086012377,
			7.18401245906,
			7.90051884036,
			8.39147370905,
			9.10975440746,
			9.81563749825,
			10.6446036792,
			11.3873034531,
			12.2352572788,
			12.9390053757,
			13.8029149085,
			14.5149287697,
			15.4385651875,
			16.1353448533,
			17.193789232,
			17.7760086791,
			18.7276556784,
			19.4254783441,
			20.2634039106,
			20.6461768777,
			22.0978719116,
			22.7039653467,
			23.8061533897,
			24.5712523907,
			25.7849750495,
			5.21450473204,
			5.55793423013,
			5.80996399898,
			6.17911516903,
			6.36181846279,
			6.71785936487,
			6.91992919848,
			7.28809275499,
			7.58170974661,
			7.93878355578,
			8.3149194367,
			8.7354349445,
			9.04104313982,
			9.47282590357,
			9.82699905899,
			10.2548996134,
			10.6693851074,
			11.1255695584,
			11.4923409731,
			11.9886111944,
			12.4474781357,
			12.981846357,
			13.4191776695,
			13.8501426442,
			14.3596401505,
			14.952221373,
			15.6934670998,
			16.3791957619,
			16.2391811459,
			16.9347751741,
			17.4973116639,
			18.2285682613,
			18.6498724976,
			19.5687388204,
			19.8301749704,
			20.7751623818,
			21.0318313219,
			22.0055166956,
			22.5502819232,
			23.479597183,
			24.043633679,
			24.9028602944,
			25.3747347092
	};

	static double[] muSixtyThree = {
			0.322883705197,
			0.163436039208,
			0.142229476833,
			0.147460563366,
			0.15605497997,
			0.172201464109,
			0.177668562903,
			0.185305530519,
			0.185092485876,
			0.206595876439,
			0.214739483955,
			0.240964075234,
			0.257921735954,
			0.29485471845,
			0.318400496586,
			0.366202443868,
			0.39412415095,
			0.415513953038,
			0.502872920837,
			0.579536409794,
			0.607923256392,
			0.669214932467,
			0.734614451851,
			0.83680598667,
			0.91776497221,
			1.04145006078,
			1.13359755354,
			1.30175666908,
			1.37036121932,
			1.51313560466,
			1.60428133703,
			1.73589309773,
			1.88998389755,
			2.00712325073,
			2.2129245194,
			2.34693531978,
			2.55164324682,
			2.75323849348,
			2.99149959011,
			3.20658423438,
			3.45438248037,
			3.6621803041,
			3.91677037876,
			4.13307971802,
			4.41266039777,
			4.62859707962,
			4.94460535982,
			5.12789141029,
			5.41251208256,
			5.63546124739,
			5.90385305903,
			6.04811102079,
			6.51002340514,
			6.72306492607,
			7.09104324637,
			7.32002640973,
			7.71044095227,
			8.13688245211,
			8.60001662699,
			8.90857984264,
			9.38733118978,
			9.55072952127,
			9.97444284259,
			10.1482131351,
			10.5667063964,
			10.8765876512,
			11.3173623774,
			11.806875898,
			11.7204228416,
			12.4970242743,
			12.9555861994,
			2.95911766702,
			3.08694248826,
			3.21101027503,
			3.34836712876,
			3.46015887675,
			3.60933887511,
			3.75133564761,
			3.91486022021,
			4.04775563648,
			4.18264054012,
			4.33895021955,
			4.52338558162,
			4.75258537634,
			4.9679040722,
			4.93351283106,
			5.15288834256,
			5.33199652516,
			5.56267981809,
			5.69993124482,
			5.99393212356,
			6.08555444025,
			6.39019210573,
			6.48638221415,
			6.803690183,
			6.99113166411,
			7.29527291751,
			7.48665956885,
			7.77301324134,
			7.9415843555
	};

	static double[] muSeventySix = {
			0.31179479444,
			0.15759887134,
			0.136833290181,
			0.141462548293,
			0.148842828129,
			0.162977851007,
			0.166226185476,
			0.170698378863,
			0.167273017457,
			0.182497298224,
			0.184922967386,
			0.201897786887,
			0.209973303398,
			0.233209344572,
			0.244725116129,
			0.273921490975,
			0.287308915158,
			0.295743295326,
			0.350269454218,
			0.3957171991,
			0.407943754438,
			0.442437466386,
			0.478920100116,
			0.539144077951,
			0.585045054278,
			0.657971108742,
			0.710616668505,
			0.810952485617,
			0.848491192392,
			0.931786010056,
			0.984046861493,
			1.06096158734,
			1.15128744014,
			1.21968047979,
			1.34165596743,
			1.42019042539,
			1.54183845789,
			1.66149842535,
			1.80362142475,
			1.93199036343,
			2.08007416693,
			2.20403368971,
			2.35776376699,
			2.48844978227,
			2.65698804643,
			2.78688755391,
			2.97835545739,
			3.09133903565,
			3.26563004166,
			3.40249135096,
			3.56730707728,
			3.65629011129,
			3.94176240612,
			4.07831300192,
			4.30542745389,
			4.44765720843,
			4.68707740706,
			4.94810247034,
			5.23215391422,
			5.43044475504,
			5.72772645526,
			5.84157373822,
			6.11357232781,
			6.24054823543,
			6.51768636877,
			6.72637664378,
			6.98417453214,
			7.25874034865,
			7.44242426447,
			7.72826548616,
			8.00631661537,
			8.21510985477,
			8.47842128081,
			8.72831209768,
			9.02384386894,
			9.25773708797,
			9.57251689748,
			2.33428474485,
			2.43480741298,
			2.51715394465,
			2.59959924446,
			2.69668003592,
			2.81097970802,
			2.9532640714,
			3.08648573814,
			3.06455709002,
			3.20123038782,
			3.31275030898,
			3.45726735691,
			3.54262066444,
			3.72751377163,
			3.78558929763,
			3.97558078018,
			4.03856045956,
			4.23678742903,
			4.35691210333,
			4.54895720371,
			4.67061356464,
			4.85364645037,
			4.96208720737
	};
	
	static Map<Integer, double[]> muMaps = new HashMap<Integer, double[]>();

}
