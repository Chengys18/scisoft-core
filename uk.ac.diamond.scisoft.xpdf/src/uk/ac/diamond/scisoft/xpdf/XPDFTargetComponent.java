/*-
 * Copyright 2015 Diamond Light Source Ltd.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 */

package uk.ac.diamond.scisoft.xpdf;

import java.util.Arrays;

import org.eclipse.dawnsci.analysis.dataset.impl.Dataset;
import org.eclipse.dawnsci.analysis.dataset.impl.DoubleDataset;
import org.eclipse.dawnsci.analysis.dataset.impl.Maths;

public class XPDFTargetComponent {

	private String name;
	private XPDFComponentForm form;
	private XPDFBeamTrace trace;
	boolean isSample;
	private double c3;
	private Dataset subBak;
	private Dataset calCon;
	private Dataset mulCor;
	
	public XPDFTargetComponent() {
		this.name="";
		this.form=null;
		this.trace=null;
		this.isSample=false;
		this.c3 = 1.0;
		this.subBak = null;
		this.calCon = null;
		this.mulCor = null;
	}

	public XPDFTargetComponent(XPDFTargetComponent inComp) {
		this.name = inComp.name;
		this.form = new XPDFComponentForm(inComp.form);
		this.trace = new XPDFBeamTrace(inComp.trace);
		this.isSample = inComp.isSample;
		this.c3 = inComp.c3;
		this.subBak = inComp.subBak != null ? inComp.subBak : null;
		this.calCon = inComp.calCon != null ? inComp.calCon : null;
		this.mulCor = inComp.mulCor != null ? inComp.mulCor : null;
	}
	
	public void setName(String name) {
		this.name = name;
	}

	public void setForm(XPDFComponentForm form) {
		this.form = form;
	}

	public void setTrace(XPDFBeamTrace trace) {
		this.trace = trace;
	}

	public void setSample(boolean isSample) {
		this.isSample = isSample;
	}

	public String getName() {
		return name;
	}

	public XPDFComponentForm getForm() {
		return form;
	}

	public XPDFBeamTrace getTrace() {
		return trace;
	}

	public boolean isSample() {
		return isSample;
	}

	public void setTraceCounts(Dataset sliceView) {
		trace.setTrace(sliceView);
	}
	
	public void setBackground(XPDFBeamTrace background) {
		subBak =  Maths.subtract(trace.getNormalizedTrace(), background.getNormalizedTrace());
	}
	
	public Dataset getBackgroundSubtractedTrace() {
		return subBak;
	}
	
	public void setCalibrationConstant(double c3) {
		this.c3 = c3;
		calCon = Maths.divide(this.subBak, this.c3);
	}
	
	public Dataset getCalibratedTrace() {
		return calCon;
	}
	
	public void setMultipleScatteringCorrection(Dataset multipleScatteringCorrection) {
		mulCor = Maths.subtract(calCon, multipleScatteringCorrection);
	}

	public Dataset getMultipleScatteringCorrectedTrace() {
		return mulCor;
	}

	public double getKroghMoeSum() {
		return form.getKroghMoeSum();
	}

	public Dataset getSelfScattering(Dataset twoTheta) {
		Dataset selfScattering = null;
		if (isSample) {
			double[] selfScaterringArray = {
				608.255443763, 608.239231464, 608.190604047, 608.109589936, 607.99623646,
				607.850609772, 607.672794755, 607.462894891, 607.221032097, 606.947346548,
				606.641996453, 606.305157825, 605.937024207, 605.537806382, 605.107732058,
				604.647045521, 604.156007278, 603.634893663, 603.083996432, 602.503622331,
				601.894092652, 601.255742758, 600.588921606, 599.89399124, 599.17132628,
				598.421313384, 597.644350715, 596.840847376, 596.011222855, 595.155906441,
				594.275336651, 593.369960635, 592.440233585, 591.486618137, 590.509583769,
				589.509606198, 588.48716678, 587.442751903, 586.376852391, 585.289962904,
				584.182581348, 583.055208283, 581.908346343, 580.742499667, 579.558173324,
				578.355872766, 577.136103277, 575.899369439, 574.646174608, 573.377020408,
				572.09240623, 570.792828751, 569.478781468, 568.150754243, 566.80923287,
				565.454698653, 564.087628002, 562.708492052, 561.317756291, 559.915880214,
				558.503316986, 557.080513135, 555.647908253, 554.205934722, 552.755017457,
				551.295573666, 549.828012633, 548.352735515, 546.870135161, 545.380595948,
				543.884493632, 542.382195226, 540.874058888, 539.360433825, 537.841660224,
				536.318069188, 534.789982698, 533.257713584, 531.721565517, 530.181833013,
				528.638801452, 527.092747112, 525.543937214, 523.992629988, 522.439074741,
				520.883511941, 519.326173321, 517.767281978, 516.207052496, 514.645691071,
				513.08339565, 511.520356074, 509.956754236, 508.392764234, 506.828552548,
				505.264278206, 503.700092969, 502.136141516, 500.572561628, 499.009484389,
				497.447034378, 495.88532987, 494.324483041, 492.76460017, 491.205781845,
				489.648123173, 488.091713984, 486.536639041, 484.982978245, 483.430806845,
				481.880195642, 480.331211191, 478.783916007, 477.238368762, 475.694624482,
				474.152734745, 472.612747868, 471.0747091, 469.538660802, 468.004642628,
				466.472691704, 464.9428428, 463.415128493, 461.889579336, 460.366224012,
				458.845089488, 457.326201167, 455.809583025, 454.295257753, 452.78324689,
				451.273570948, 449.766249534, 448.261301471, 446.758744902, 445.258597403,
				443.76087608, 442.265597663, 440.7727786, 439.282435138, 437.794583403,
				436.309239477, 434.826419464, 433.346139558, 431.868416099, 430.393265631,
				428.920704948, 427.450751145, 425.983421656, 424.518734293, 423.056707274,
				421.597359259, 420.14070937, 418.686777215, 417.235582902, 415.787147059,
				414.341490837, 412.898635928, 411.458604558, 410.021419498, 408.587104061,
				407.155682095, 405.72717798, 404.30161662, 402.879023433, 401.459424334,
				400.04284573, 398.629314492, 397.21885795, 395.811503863, 394.407280407,
				393.006216147, 391.608340019, 390.213681303, 388.822269601, 387.434134808,
				386.04930709, 384.667816856, 383.289694728, 381.91497152, 380.543678203,
				379.175845881, 377.811505763, 376.450689133, 375.093427326, 373.739751693,
				372.38969358, 371.043284297, 369.700555092, 368.361537123, 367.026261433,
				365.69475892, 364.367060318, 363.043196165, 361.723196784, 360.407092255,
				359.094912394, 357.786686728, 356.482444476, 355.182214526, 353.886025415,
				352.593905306, 351.305881974, 350.021982784, 348.742234674, 347.466664138,
				346.195297213, 344.928159456, 343.665275939, 342.406671226, 341.152369368,
				339.902393884, 338.656767755, 337.415513408, 336.17865271, 334.946206958,
				333.718196867, 332.494642566, 331.27556359, 330.06097887, 328.850906734,
				327.645364894, 326.444370447, 325.247939868, 324.056089009, 322.868833093,
				321.686186716, 320.508163841, 319.3347778, 318.166041292, 317.001966384,
				315.84256451, 314.687846472, 313.537822443, 312.392501966, 311.251893961,
				310.11600672, 308.984847918, 307.85842461, 306.73674324, 305.61980964,
				304.507629037, 303.400206059, 302.297544736, 301.199648509, 300.106520234,
				299.018162186, 297.934576069, 296.855763016, 295.781723603, 294.71245785,
				293.647965227, 292.588244668, 291.533294568, 290.4831128, 289.437696714,
				288.39704315, 287.361148443, 286.330008433, 285.303618469, 284.281973419,
				283.265067679, 282.252895179, 281.245449391, 280.242723338, 279.244709603,
				278.251400335, 277.262787257, 276.278861678, 275.299614496, 274.32503621,
				273.355116924, 272.389846362, 271.429213869, 270.473208423, 269.521818644,
				268.575032797, 267.632838806, 266.69522426, 265.762176418, 264.833682222,
				263.9097283, 262.990300978, 262.075386285, 261.164969962, 260.259037469,
				259.357573993, 258.460564458, 257.567993526, 256.679845611, 255.796104884,
				254.916755278, 254.041780501, 253.171164035, 252.304889152, 251.442938913,
				250.58529618, 249.731943622, 248.882863719, 248.038038772, 247.197450908,
				246.361082087, 245.528914109, 244.700928616, 243.877107106, 243.057430932,
				242.241881314, 241.430439337, 240.623085967, 239.819802049, 239.020568316,
				238.225365393, 237.434173806, 236.646973982, 235.863746261, 235.084470894,
				234.309128055, 233.537697841, 232.770160281, 232.006495337, 231.246682912,
				230.490702854, 229.73853496, 228.990158982, 228.245554628, 227.504701572,
				226.767579454, 226.034167886, 225.304446455, 224.578394729, 223.855992259,
				223.137218586, 222.422053241, 221.710475752, 221.002465645, 220.29800245,
				219.597065704, 218.899634954, 218.205689759, 217.515209697, 216.828174366,
				216.144563386, 215.464356404, 214.787533099, 214.114073179, 213.44395639,
				212.777162516, 212.113671381, 211.453462854, 210.796516849, 210.142813333,
				209.492332319, 208.84505388, 208.20095814, 207.560025286, 206.922235563,
				206.287569282, 205.656006818, 205.027528613, 204.402115179, 203.779747101,
				203.160405034, 202.544069712, 201.930721944, 201.320342617, 200.7129127,
				200.108413245, 199.506825384, 198.908130339, 198.312309414, 197.719344004,
				197.129215592, 196.541905755, 195.957396156, 195.375668558, 194.796704813,
				194.220486872, 193.646996782, 193.076216686, 192.508128827, 191.942715549,
				191.379959294, 190.819842608, 190.262348137, 189.707458631, 189.155156944,
				188.605426035, 188.058248967, 187.51360891, 186.97148914, 186.431873039,
				185.894744098, 185.360085914, 184.827882196, 184.298116758, 183.770773525,
				183.245836532, 182.723289923, 182.203117953, 181.685304986, 181.169835498,
				180.656694075, 180.145865416, 179.637334328, 179.131085733, 178.62710466,
				178.125376253, 177.625885766, 177.128618565, 176.633560126, 176.140696039,
				175.650012002, 175.161493827, 174.675127436, 174.190898862, 173.708794248,
				173.228799849, 172.75090203, 172.275087266, 171.801342141, 171.329653351,
				170.860007699, 170.392392099, 169.926793572, 169.463199248, 169.001596366,
				168.541972273, 168.084314421, 167.62861037, 167.174847788, 166.723014448,
				166.273098227, 165.825087111, 165.378969186, 164.934732646, 164.492365787,
				164.051857009, 163.613194813, 163.176367804, 162.741364688, 162.308174271,
				161.876785462, 161.447187266, 161.019368792, 160.593319243, 160.169027924,
				159.746484235, 159.325677674, 158.906597835, 158.489234406, 158.073577173,
				157.659616015, 157.247340903, 156.836741903, 156.427809172, 156.02053296,
				155.614903606, 155.210911542, 154.808547286, 154.407801449, 154.008664726,
				153.611127903, 153.21518185, 152.820817524, 152.428025969, 152.036798311,
				151.647125761, 151.258999613, 150.872411244, 150.487352112, 150.103813757,
				149.721787798, 149.341265933, 148.962239942, 148.584701679, 148.208643078,
				147.834056148, 147.460932976, 147.089265722, 146.71904662, 146.350267981,
				145.982922184, 145.617001685, 145.252499009, 144.88940675, 144.527717577,
				144.167424223, 143.808519492, 143.450996256, 143.094847454, 142.74006609,
				142.386645236, 142.034578027, 141.683857662, 141.334477404, 140.986430581,
				140.63971058, 140.29431085, 139.950224902, 139.607446306, 139.265968691,
				138.925785746, 138.586891216, 138.249278905, 137.912942672, 137.577876433,
				137.244074159, 136.911529875, 136.58023766, 136.250191647, 135.92138602,
				135.593815018, 135.267472927, 134.942354086, 134.618452884, 134.29576376,
				133.974281199, 133.653999737, 133.334913956, 133.017018485, 132.700307999,
				132.38477722, 132.070420914, 131.75723389, 131.445211004, 131.134347152,
				130.824637276, 130.516076357, 130.20865942, 129.902381529, 129.59723779,
				129.293223347, 128.990333386, 128.688563129, 128.387907838, 128.088362813,
				127.789923389, 127.492584939, 127.196342873, 126.901192636, 126.607129707,
				126.3141496, 126.022247865, 125.731420084, 125.441661871, 125.152968875,
				124.865336776, 124.578761287, 124.29323815, 124.008763139, 123.725332059,
				123.442940744, 123.161585057, 122.881260893, 122.601964171, 122.323690841,
				122.046436882, 121.770198296, 121.494971117, 121.220751402, 120.947535235,
				120.675318726, 120.404098012, 120.133869251, 119.864628629, 119.596372354,
				119.329096661, 119.062797805, 118.797472066, 118.533115746, 118.26972517,
				118.007296684, 117.745826658, 117.485311482, 117.225747566, 116.967131342,
				116.709459263, 116.452727801, 116.196933448, 115.942072716, 115.688142137,
				115.43513826, 115.183057653, 114.931896905, 114.681652618, 114.432321418,
				114.183899943, 113.936384851, 113.689772818, 113.444060533, 113.199244706,
				112.95532206, 112.712289335, 112.470143287, 112.228880687, 111.988498322,
				111.748992993, 111.510361516, 111.272600724, 111.03570746, 110.799678585,
				110.564510971, 110.330201507, 110.096747093, 109.864144643, 109.632391084,
				109.401483357, 109.171418415, 108.942193222, 108.713804758, 108.486250012,
				108.259525987, 108.033629696, 107.808558166, 107.584308434, 107.36087755,
				107.138262572, 106.916460572, 106.695468633, 106.475283846, 106.255903316,
				106.037324157, 105.819543492, 105.602558457, 105.386366196, 105.170963863,
				104.956348624, 104.742517652, 104.529468131, 104.317197254, 104.105702224,
				103.894980252, 103.68502856, 103.475844376, 103.267424941, 103.059767501,
				102.852869314, 102.646727643, 102.441339762, 102.236702953, 102.032814506,
				101.82967172, 101.6272719, 101.425612362, 101.224690428, 101.024503428,
				100.825048701, 100.626323592, 100.428325455, 100.231051651, 100.034499548,
				99.8386665236, 99.6435499601, 99.4491472485, 99.2554557869, 99.0624729802,
				98.8701962409, 98.6786229882, 98.4877506484, 98.2975766548, 98.1080984475,
				97.9193134735, 97.7312191865, 97.5438130469, 97.357092522, 97.1710550854,
				96.9856982177, 96.8010194056, 96.6170161426, 96.4336859286, 96.2510262698,
				96.069034679, 95.8877086751, 95.7070457835, 95.5270435357, 95.3476994695,
				95.1690111291, 94.9909760645, 94.8135918321, 94.6368559943, 94.4607661197,
				94.2853197828, 94.1105145642, 93.9363480505, 93.7628178344, 93.5899215142,
				93.4176566944, 93.2460209855, 93.0750120036, 92.9046273709, 92.7348647152,
				92.5657216704, 92.3971958761, 92.2292849775, 92.0619866259, 91.8952984781,
				91.7292181969, 91.5637434505, 91.398871913, 91.2346012643, 91.0709291898,
				90.9078533806, 90.7453715336, 90.5834813513, 90.4221805418, 90.2614668188,
				90.1013379016, 89.9417915154, 89.7828253908, 89.6244372638, 89.4666248764,
				89.3093859759, 89.1527183153, 88.9966196532, 88.8410877537, 88.6861203865,
				88.5317153269, 88.3778703556, 88.224583259, 88.0718518291, 87.9196738634,
				87.7680471648, 87.6169695418, 87.4664388087, 87.3164527851, 87.167009296,
				87.0181061723, 86.8697412502, 86.7219123714, 86.5746173833, 86.4278541387,
				86.2816204961, 86.1359143192, 85.9907334777, 85.8460758463, 85.7019393058,
				85.5583217421, 85.4152210469, 85.2726351171, 85.1305618556, 84.9889991706,
				84.8479449757, 84.7073971903, 84.5673537393, 84.4278125529, 84.2887715673,
				84.1502287237, 84.0121819694, 83.8746292568, 83.7375685442, 83.6009977953,
				83.4649149794, 83.3293180712, 83.1942050513, 83.0595739056, 82.9254226257,
				82.7917492087, 82.6585516574, 82.52582798, 82.3935761904, 82.2617943082,
				82.1304803583, 81.9996323714, 81.8692483838, 81.7393264373, 81.6098645794,
				81.4808608632, 81.3523133472, 81.2242200957, 81.0965791787, 80.9693886716,
				80.8426466555, 80.7163512172, 80.590500449, 80.4650924489, 80.3401253205,
				80.2155971729, 80.0915061212, 79.9678502857, 79.8446277926, 79.7218367736,
				79.5994753662, 79.4775417133, 79.3560339638, 79.2349502718, 79.1142887974,
				78.9940477063, 78.8742251696, 78.7548193643, 78.6358284729, 78.5172506838,
				78.3990841907, 78.2813271933, 78.1639778966, 78.0470345116, 77.9304952548,
				77.8143583483, 77.69862202, 77.5832845033, 77.4683440374, 77.3537988671,
				77.2396472429, 77.1258874208, 77.0125176628, 76.8995362362, 76.7869414141,
				76.6747314753, 76.5629047042, 76.451459391, 76.3403938314, 76.2297063267,
				76.119395184, 76.0094587161, 75.8998952413, 75.7907030837, 75.6818805728,
				75.5734260441, 75.4653378385, 75.3576143026, 75.2502537887, 75.1432546547,
				75.0366152641, 74.9303339862, 74.8244091957, 74.7188392732, 74.6136226046,
				74.5087575818, 74.404242602, 74.3000760683, 74.1962563892, 74.0927819789,
				73.9896512573, 73.8868626498, 73.7844145874, 73.6823055067, 73.5805338501,
				73.4790980653, 73.3779966058, 73.2772279306, 73.1767905044, 73.0766827972,
				72.9769032848, 72.8774504487, 72.7783227756, 72.6795187581, 72.5810368942,
				72.4828756874, 72.3850336468, 72.2875092872, 72.1903011286, 72.093407697,
				71.9968275234, 71.9005591446, 71.8046011031, 71.7089519465, 71.6136102281,
				71.5185745069, 71.423843347, 71.3294153182, 71.2352889958, 71.1414629606,
				71.0479357987, 70.9547061017, 70.8617724668, 70.7691334966, 70.676787799,
				70.5847339874, 70.4929706807, 70.4014965032, 70.3103100846, 70.2194100598,
				70.1287950695, 70.0384637595, 69.9484147809, 69.8586467905, 69.7691584502,
				69.6799484274, 69.5910153947, 69.5023580302, 69.4139750173, 69.3258650446,
				69.2380268061, 69.1504590012, 69.0631603345, 68.9761295159, 68.8893652605,
				68.8028662888, 68.7166313266, 68.6306591048, 68.5449483596, 68.4594978326,
				68.3743062704, 68.2893724249, 68.2046950533, 68.1202729178, 68.036104786,
				67.9521894306, 67.8685256295, 67.7851121656, 67.7019478272, 67.6190314076,
				67.5363617052, 67.4539375236, 67.3717576716, 67.2898209629, 67.2081262164,
				67.1266722561, 67.045457911, 66.9644820152, 66.883743408, 66.8032409334,
				66.7229734408, 66.6429397844, 66.5631388234, 66.4835694221, 66.4042304497,
				66.3251207805, 66.2462392937, 66.1675848734, 66.0891564087, 66.0109527937,
				65.9329729272, 65.8552157131, 65.7776800602, 65.7003648822, 65.6232690975,
				65.5463916296, 65.4697314067, 65.3932873618, 65.317058433, 65.2410435629,
				65.1652416991, 65.089651794, 65.0142728046, 64.9391036929, 64.8641434256,
				64.789390974, 64.7148453144, 64.6405054276, 64.5663702992, 64.4924389195,
				64.4187102835, 64.345183391, 64.2718572461, 64.1987308579, 64.1258032401,
				64.0530734109, 63.9805403932, 63.9082032145, 63.8360609069, 63.764112507,
				63.692357056, 63.6207935999, 63.5494211888, 63.4782388777, 63.407245726,
				63.3364407975, 63.2658231606, 63.1953918882, 63.1251460577, 63.0550847508,
				62.9852070539, 62.9155120574, 62.8459988566, 62.776666551, 62.7075142444,
				62.6385410451, 62.5697460658, 62.5011284234, 62.4326872393, 62.3644216391,
				62.2963307528, 62.2284137148, 62.1606696636, 62.0930977421, 62.0256970973,
				61.9584668807, 61.8914062479, 61.8245143587, 61.7577903771, 61.6912334715,
				61.6248428143, 61.558617582, 61.4925569556, 61.4266601198, 61.3609262638,
				61.2953545807, 61.2299442679, 61.1646945267, 61.0996045626, 61.0346735852,
				60.969900808, 60.9052854487, 60.840826729, 60.7765238746, 60.7123761152,
				60.6483826844, 60.5845428199, 60.5208557634, 60.4573207604, 60.3939370605,
				60.3307039171, 60.2676205876, 60.2046863332, 60.1419004191, 60.0792621143,
				60.0167706916, 59.9544254279, 59.8922256035, 59.830170503, 59.7682594145,
				59.70649163, 59.6448664452, 59.5833831596, 59.5220410766, 59.4608395031,
				59.3997777499, 59.3388551314, 59.2780709658, 59.217424575, 59.1569152844,
				59.0965424232, 59.0363053243, 58.9762033241, 58.9162357628, 58.8564019839,
				58.7967013348, 58.7371331664, 58.6776968331, 58.6183916928, 58.5592171072,
				58.5001724412, 58.4412570636, 58.3824703462, 58.3238116648, 58.2652803983,
				58.2068759294, 58.1485976438, 58.0904449312, 58.0324171841, 57.974513799,
				57.9167341755, 57.8590777164, 57.8015438284, 57.744131921, 57.6868414074,
				57.629671704, 57.5726222306, 57.5156924102, 57.4588816692, 57.4021894372,
				57.345615147, 57.2891582349, 57.2328181402, 57.1765943055, 57.1204861767,
				57.0644932029, 57.0086148362, 56.952850532, 56.897199749, 56.8416619488,
				56.7862365963, 56.7309231595, 56.6757211095, 56.6206299204, 56.5656490697,
				56.5107780375, 56.4560163075, 56.4013633659, 56.3468187024, 56.2923818094,
				56.2380521825, 56.1838293203, 56.1297127242, 56.0757018988, 56.0217963515,
				55.9679955927, 55.9142991358, 55.860706497, 55.8072171955, 55.7538307534,
				55.7005466956, 55.6473645499, 55.5942838471, 55.5413041207, 55.488424907,
				55.4356457453, 55.3829661775, 55.3303857484, 55.2779040056, 55.2255204996,
				55.1732347833, 55.1210464127, 55.0689549464, 55.0169599457, 54.9650609746,
				54.9132575999, 54.861549391, 54.8099359201, 54.7584167618, 54.7069914936,
				54.6556596955, 54.6044209503, 54.5532748432, 54.5022209622, 54.4512588976,
				54.4003882427, 54.3496085929, 54.2989195466, 54.2483207044, 54.1978116696,
				54.147392048, 54.0970614479, 54.0468194801, 53.9966657578, 53.9465998967,
				53.8966215152, 53.8467302337, 53.7969256755, 53.747207466, 53.6975752332,
				53.6480286073, 53.5985672212, 53.5491907098, 53.4998987107, 53.4506908636,
				53.4015668108, 53.3525261967, 53.3035686682, 53.2546938743, 53.2059014665,
				53.1571910986, 53.1085624264, 53.0600151083, 53.0115488047, 52.9631631784,
				52.9148578944, 52.8666326199, 52.8184870242, 52.7704207791, 52.7224335582,
				52.6745250375, 52.6266948952, 52.5789428115, 52.5312684689, 52.4836715519,
				52.4361517472, 52.3887087435, 52.3413422318, 52.294051905, 52.2468374582,
				52.1996985884, 52.1526349949, 52.1056463788, 52.0587324434, 52.011892894,
				51.9651274377, 51.918435784, 51.871817644, 51.8252727311, 51.7788007604,
				51.7324014491, 51.6860745163, 51.6398196832, 51.5936366726, 51.5475252096,
				51.5014850209, 51.4555158352, 51.4096173832, 51.3637893973, 51.3180316119,
				51.2723437631, 51.226725589, 51.1811768296, 51.1356972264, 51.090286523,
				51.0449444647, 50.9996707987, 50.9544652739, 50.9093276408, 50.8642576521,
				50.8192550619, 50.7743196261, 50.7294511024, 50.6846492502, 50.6399138307,
				50.5952446066, 50.5506413426, 50.5061038047, 50.461631761, 50.4172249809,
				50.3728832357, 50.3286062982, 50.2843939429, 50.2402459461, 50.1961620853,
				50.1521421401, 50.1081858913, 50.0642931214, 50.0204636148, 49.9766971569,
				49.9329935352, 49.8893525385, 49.845773957, 49.8022575828, 49.7588032093,
				49.7154106314, 49.6720796455, 49.6288100497, 49.5856016434, 49.5424542275,
				49.4993676045, 49.4563415781, 49.4133759538, 49.3704705382, 49.3276251397,
				49.2848395678, 49.2421136336, 49.1994471496, 49.1568399296, 49.1142917889,
				49.0718025441, 49.0293720132, 48.9870000157, 48.9446863723, 48.9024309051,
				48.8602334375, 48.8180937944, 48.7760118017, 48.7339872869, 48.6920200788,
				48.6501100073, 48.6082569038, 48.5664606009, 48.5247209324, 48.4830377336,
				48.4414108407, 48.3998400914, 48.3583253247, 48.3168663807, 48.2754631007,
				48.2341153272, 48.1928229041, 48.1515856764, 48.1104034902, 48.0692761929,
				48.0282036331, 47.9871856604, 47.9462221258, 47.9053128812, 47.8644577799,
				47.8236566762, 47.7829094255, 47.7422158845, 47.7015759108, 47.6609893632,
				47.6204561017, 47.5799759872, 47.5395488818, 47.4991746488, 47.4588531523,
				47.4185842576, 47.3783678313, 47.3382037405, 47.2980918539, 47.2580320409,
				47.218024172, 47.1780681189, 47.1381637539, 47.0983109508, 47.0585095841,
				47.0187595293, 46.9790606631, 46.9394128628, 46.8998160071, 46.8602699754,
				46.8207746481, 46.7813299066, 46.7419356333, 46.7025917113, 46.6632980248,
				46.6240544591, 46.5848609, 46.5457172347, 46.5066233508, 46.4675791371,
				46.4285844834, 46.38963928, 46.3507434185, 46.311896791, 46.2730992908,
				46.2343508117, 46.1956512487, 46.1570004974, 46.1183984544, 46.0798450171,
				46.0413400836, 46.002883553, 45.964475325, 45.9261153003, 45.8878033804,
				45.8495394675, 45.8113234646, 45.7731552756, 45.7350348049, 45.6969619581,
				45.6589366411, 45.6209587609, 45.5830282251, 45.5451449422, 45.5073088212,
				45.469519772, 45.4317777052, 45.3940825321, 45.3564341648, 45.3188325161,
				45.2812774993, 45.2437690287, 45.2063070191, 45.1688913861, 45.1315220459,
				45.0941989154, 45.0569219122, 45.0196909547, 44.9825059616, 44.9453668527,
				44.908273548, 44.8712259686, 44.834224036, 44.7972676722, 44.7603568001,
				44.7234913432, 44.6866712254, 44.6498963715, 44.6131667066, 44.5764821567,
				44.5398426482, 44.5032481082, 44.4666984644, 44.430193645, 44.3937335789,
				44.3573181954, 44.3209474244, 44.2846211967, 44.2483394431, 44.2121020955,
				44.1759090859, 44.1397603472, 44.1036558127, 44.0675954161, 44.0315790918,
				43.9956067748, 43.9596784004, 43.9237939045, 43.8879532236, 43.8521562947,
				43.8164030551, 43.7806934429, 43.7450273965, 43.7094048548, 43.6738257573,
				43.6382900439, 43.6027976549, 43.5673485313, 43.5319426142, 43.4965798456,
				43.4612601677, 43.4259835232, 43.3907498552, 43.3555591073, 43.3204112237,
				43.2853061487, 43.2502438274, 43.215224205, 43.1802472273, 43.1453128406,
				43.1104209914, 43.0755716269, 43.0407646944, 43.0060001418, 42.9712779173,
				42.9365979696, 42.9019602478, 42.8673647013, 42.8328112798, 42.7982999338,
				42.7638306136, 42.7294032703, 42.6950178552, 42.66067432, 42.6263726168,
				42.5921126981, 42.5578945165, 42.5237180253, 42.4895831779, 42.4554899282,
				42.4214382303, 42.3874280388, 42.3534593086, 42.3195319947, 42.2856460528,
				42.2518014386, 42.2179981084, 42.1842360186, 42.150515126, 42.1168353877,
				42.0831967612, 42.0495992041, 42.0160426745, 41.9825271307, 41.9490525313,
				41.9156188352, 41.8822260017, 41.8488739902, 41.8155627605, 41.7822922726,
				41.7490624868, 41.7158733639, 41.6827248645, 41.6496169499, 41.6165495814,
				41.5835227207, 41.5505363298, 41.5175903708, 41.4846848061, 41.4518195983,
				41.4189947105, 41.3862101058, 41.3534657476, 41.3207615995, 41.2880976254,
				41.2554737895, 41.222890056, 41.1903463895, 41.1578427548, 41.125379117,
				41.0929554412, 41.060571693, 41.0282278379, 40.9959238418, 40.9636596708,
				40.9314352913, 40.8992506696, 40.8671057724, 40.8350005668, 40.8029350196,
				40.7709090983, 40.7389227702, 40.7069760031, 40.6750687647, 40.643201023,
				40.6113727463, 40.579583903, 40.5478344615, 40.5161243907, 40.4844536594,
				40.4528222367, 40.4212300917, 40.389677194, 40.358163513, 40.3266890185,
				40.2952536804, 40.2638574686, 40.2325003535, 40.2011823052, 40.1699032942,
				40.1386632913, 40.1074622672, 40.0763001927, 40.045177039, 40.0140927772,
				39.9830473787, 39.9520408149, 39.9210730574, 39.8901440779, 39.8592538484,
				39.8284023407, 39.797589527, 39.7668153795, 39.7360798705, 39.7053829725,
				39.6747246581, 39.6441049, 39.6135236709, 39.5829809438, 39.5524766918,
				39.5220108879, 39.4915835053, 39.4611945175, 39.4308438978, 39.4005316199,
				39.3702576573, 39.3400219837, 39.3098245731, 39.2796653993, 39.2495444364,
				39.2194616584, 39.1894170395, 39.1594105541, 39.1294421765, 39.0995118811,
				39.0696196424, 39.0397654352, 39.009949234, 38.9801710136, 38.9504307489,
				38.9207284147, 38.8910639861, 38.8614374382, 38.8318487459, 38.8022978847,
				38.7727848296, 38.743309556, 38.7138720393, 38.684472255, 38.6551101786,
				38.6257857855, 38.5964990516, 38.5672499524, 38.5380384637, 38.5088645613,
				38.479728221, 38.4506294188, 38.4215681305, 38.3925443322, 38.3635579999,
				38.3346091097, 38.3056976377, 38.2768235602, 38.2479868533, 38.2191874933,
				38.1904254565, 38.1617007193, 38.1330132579, 38.1043630489, 38.0757500687,
				38.0471742937, 38.0186357006, 37.9901342657, 37.9616699658, 37.9332427774,
				37.9048526772, 37.8764996418, 37.8481836479, 37.8199046722, 37.7916626915,
				37.7634576825, 37.7352896221, 37.707158487, 37.6790642541, 37.6510069002,
				37.6229864022, 37.5950027369, 37.5670558813, 37.5391458123, 37.5112725068,
				37.4834359418, 37.4556360942, 37.4278729409, 37.400146459, 37.3724566255,
				37.3448034173, 37.3171868114, 37.289606785, 37.2620633149, 37.2345563782,
				37.207085952, 37.1796520133, 37.1522545391, 37.1248935065, 37.0975688925,
				37.0702806741, 37.0430288284, 37.0158133325, 36.9886341633, 36.961491298,
				36.9343847136, 36.907314387, 36.8802802953, 36.8532824156, 36.8263207249,
				36.7993952002, 36.7725058184, 36.7456525566, 36.7188353918, 36.6920543009,
				36.665309261, 36.6386002489, 36.6119272417, 36.5852902162, 36.5586891495,
				36.5321240183, 36.5055947997, 36.4791014704, 36.4526440074, 36.4262223875,
				36.3998365876, 36.3734865845, 36.3471723549, 36.3208938757, 36.2946511237,
				36.2684440755, 36.242272708, 36.2161369979, 36.1900369217, 36.1639724563,
				36.1379435782, 36.1119502642, 36.0859924907, 36.0600702345, 36.034183472,
				36.0083321797, 35.9825163343, 35.9567359122, 35.9309908899, 35.9052812438,
				35.8796069503, 35.8539679858, 35.8283643267, 35.8027959493, 35.77726283,
				35.7517649449, 35.7263022705, 35.7008747828, 35.6754824581, 35.6501252726,
				35.6248032023, 35.5995162235, 35.5742643122, 35.5490474444, 35.5238655961,
				35.4987187434, 35.4736068621, 35.4485299283, 35.4234879178, 35.3984808064,
				35.3735085701, 35.3485711845, 35.3236686254, 35.2988008686, 35.2739678898,
				35.2491696646, 35.2244061686, 35.1996773774, 35.1749832666, 35.1503238117,
				35.1256989882, 35.1011087715, 35.076553137, 35.0520320601, 35.0275455162,
				35.0030934805, 34.9786759284, 34.954292835, 34.9299441755, 34.905629925,
				34.8813500588, 34.8571045519, 34.8328933792, 34.8087165159, 34.7845739368,
				34.760465617, 34.7363915312, 34.7123516543, 34.6883459612, 34.6643744266,
				34.6404370252, 34.6165337317, 34.5926645208, 34.5688293671, 34.5450282451,
				34.5212611294, 34.4975279944, 34.4738288147, 34.4501635645, 34.4265322184,
				34.4029347505, 34.3793711353, 34.3558413469, 34.3323453595, 34.3088831474,
				34.2854546846, 34.2620599452, 34.2386989032, 34.2153715326, 34.1920778075,
				34.1688177017, 34.1455911891, 34.1223982434, 34.0992388386, 34.0761129483,
				34.0530205463, 34.0299616062, 34.0069361017, 33.9839440062, 33.9609852934,
				33.9380599368, 33.9151679097, 33.8923091857, 33.8694837381, 33.8466915401,
				33.8239325651, 33.8012067864, 33.7785141771, 33.7558547104, 33.7332283594,
				33.7106350971, 33.6880748966, 33.665547731, 33.643053573, 33.6205923957,
				33.5981641719, 33.5757688744, 33.553406476, 33.5310769494, 33.5087802673,
				33.4865164024, 33.4642853272, 33.4420870144, 33.4199214364, 33.3977885657,
				33.3756883748, 33.3536208361, 33.3315859219, 33.3095836045, 33.2876138562,
				33.2656766493, 33.2437719558, 33.221899748, 33.200059998, 33.1782526778,
				33.1564777594, 33.1347352149, 33.1130250161, 33.0913471349, 33.0697015432,
				33.0480882129, 33.0265071156, 33.0049582232, 32.9834415072, 32.9619569394,
				32.9405044914, 32.9190841346, 32.8976958408, 32.8763395812, 32.8550153274,
				32.8337230508, 32.8124627228, 32.7912343146, 32.7700377975, 32.7488731429,
				32.7277403218, 32.7066393055, 32.6855700651, 32.6645325716, 32.6435267961,
				32.6225527097, 32.6016102832, 32.5806994876, 32.5598202938, 32.5389726726,
				32.5181565949, 32.4973720314, 32.4766189528, 32.4558973298, 32.4352071332,
				32.4145483334, 32.3939209012, 32.3733248069, 32.3527600212, 32.3322265145,
				32.3117242572, 32.2912532196, 32.2708133723, 32.2504046854, 32.2300271293,
				32.2096806741, 32.1893652902, 32.1690809476, 32.1488276165, 32.1286052669,
				32.1084138691, 32.0882533928, 32.0681238083, 32.0480250853, 32.0279571938,
				32.0079201038, 31.9879137849, 31.9679382071, 31.9479933402, 31.9280791538,
				31.9081956176, 31.8883427014, 31.8685203747, 31.8487286072, 31.8289673685,
				31.809236628, 31.7895363552, 31.7698665197, 31.7502270908, 31.730618038,
				31.7110393307, 31.6914909381, 31.6719728295, 31.6524849742, 31.6330273416,
				31.6135999006, 31.5942026207, 31.5748354707, 31.55549842, 31.5361914375,
				31.5169144923, 31.4976675534, 31.4784505898, 31.4592635704, 31.4401064642,
				31.4209792401, 31.4018818668, 31.3828143133, 31.3637765484, 31.3447685407,
				31.3257902591, 31.3068416723, 31.2879227488, 31.2690334575, 31.2501737669,
				31.2313436456, 31.2125430622, 31.1937719852, 31.1750303831, 31.1563182244,
				31.1376354776, 31.1189821111, 31.1003580932, 31.0817633924, 31.063197977,
				31.0446618153, 31.0261548757, 31.0076771263, 30.9892285354, 30.9708090712,
				30.952418702, 30.9340573958, 30.9157251209, 30.8974218452, 30.879147537,
				30.8609021643, 30.842685695, 30.8244980973, 30.806339339, 30.7882093883,
				30.7701082129, 30.7520357808, 30.73399206, 30.7159770182, 30.6979906234,
				30.6800328433, 30.6621036458, 30.6442029985, 30.6263308694, 30.608487226,
				30.5906720362, 30.5728852676, 30.5551268879, 30.5373968647, 30.5196951656,
				30.5020217583, 30.4843766103, 30.4667596892, 30.4491709625, 30.4316103978,
				30.4140779626, 30.3965736243, 30.3790973504, 30.3616491084, 30.3442288656,
				30.3268365895, 30.3094722474, 30.2921358068, 30.274827235, 30.2575464993,
				30.240293567, 30.2230684054, 30.2058709818, 30.1887012635, 30.1715592176,
				30.1544448115, 30.1373580123, 30.1202987872, 30.1032671035, 30.0862629282,
				30.0692862284, 30.0523369715, 30.0354151243, 30.0185206541, 30.001653528,
				29.9848137129, 29.9680011759, 29.9512158842, 29.9344578046, 29.9177269042,
				29.9010231501, 29.8843465091, 29.8676969483, 29.8510744345, 29.8344789349,
				29.8179104161, 29.8013688453, 29.7848541893, 29.7683664149, 29.7519054891,
				29.7354713787, 29.7190640506, 29.7026834716, 29.6863296086, 29.6700024283,
				29.6537018976, 29.6374279832, 29.621180652, 29.6049598708, 29.5887656062,
				29.5725978251, 29.5564564942, 29.5403415802, 29.5242530498, 29.5081908699,
				29.492155007, 29.4761454279, 29.4601620993, 29.4442049878, 29.4282740602,
				29.412369283, 29.396490623, 29.3806380468, 29.3648115211, 29.3490110124,
				29.3332364874, 29.3174879127, 29.301765255, 29.2860684808, 29.2703975567,
				29.2547524494, 29.2391331254, 29.2235395514, 29.2079716938, 29.1924295192,
				29.1769129943, 29.1614220855, 29.1459567595, 29.1305169828, 29.1151027218,
				29.0997139433, 29.0843506137, 29.0690126995, 29.0537001673, 29.0384129836,
				29.0231511149, 29.0079145277, 28.9927031887, 28.9775170641, 28.9623561207,
				28.9472203248, 28.9321096431, 28.9170240419, 28.9019634879, 28.8869279474,
				28.8719173871, 28.8569317733, 28.8419710727, 28.8270352516, 28.8121242766,
				28.7972381141, 28.7823767308, 28.7675400929, 28.7527281672, 28.73794092,
				28.7231783178, 28.7084403271, 28.6937269144, 28.6790380463, 28.6643736891,
				28.6497338095, 28.6351183738, 28.6205273487, 28.6059607005, 28.5914183958,
				28.5769004011, 28.562406683, 28.5479372078, 28.5334919421, 28.5190708525,
				28.5046739054, 28.4903010674, 28.475952305, 28.4616275847, 28.447326873,
				28.4330501365, 28.4187973417, 28.4045684552, 28.3903634434, 28.3761822729,
				28.3620249104, 28.3478913223, 28.3337814752, 28.3196953357, 28.3056328703,
				28.2915940456, 28.2775788282, 28.2635871848, 28.2496190818, 28.2356744859,
				28.2217533636, 28.2078556817, 28.1939814067, 28.1801305053, 28.166302944,
				28.1524986895, 28.1387177085, 28.1249599676, 28.1112254335, 28.0975140728,
				28.0838258522, 28.0701607384, 28.0565186981, 28.042899698, 28.0293037048,
				28.0157306852, 28.0021806059, 27.9886534337, 27.9751491353, 27.9616676775,
				27.9482090269, 27.9347731505, 27.921360015, 27.9079695871, 27.8946018336,
				27.8812567214, 27.8679342173, 27.8546342881, 27.8413569007, 27.8281020219,
				27.8148696185, 27.8016596575, 27.7884721056, 27.7753069299, 27.7621640972,
				27.7490435744, 27.7359453285, 27.7228693264, 27.709815535, 27.6967839214,
				27.6837744524, 27.6707870951, 27.6578218165, 27.6448785836, 27.6319573634,
				27.6190581229, 27.6061808292, 27.5933254494, 27.5804919506, 27.5676802997,
				27.554890464, 27.5421224106, 27.5293761066, 27.5166515191, 27.5039486153,
				27.4912673623, 27.4786077274, 27.4659696778, 27.4533531807, 27.4407582032,
				27.4281847127, 27.4156326765, 27.4031020617, 27.3905928357, 27.3781049658,
				27.3656384193, 27.3531931636, 27.340769166, 27.3283663939, 27.3159848147,
				27.3036243957, 27.2912851044, 27.2789669082, 27.2666697746, 27.2543936711,
				27.2421385651, 27.2299044241, 27.2176912157, 27.2054989073, 27.1933274666,
				27.1811768612, 27.1690470585, 27.1569380262, 27.1448497319, 27.1327821434,
				27.1207352281, 27.1087089539, 27.0967032884, 27.0847181993, 27.0727536543,
				27.0608096213, 27.0488860679, 27.036982962, 27.0251002713, 27.0132379638,
				27.0013960072, 26.9895743694, 26.9777730182, 26.9659919217, 26.9542310477,
				26.9424903642, 26.9307698391, 26.9190694404, 26.9073891361, 26.8957288942,
				26.8840886828, 26.87246847, 26.8608682237, 26.8492879122, 26.8377275036,
				26.8261869659, 26.8146662674, 26.8031653763, 26.7916842607, 26.780222889,
				26.7687812292, 26.7573592498, 26.745956919, 26.7345742051, 26.7232110765,
				26.7118675015, 26.7005434485, 26.6892388859, 26.6779537821, 26.6666881057,
				26.6554418249, 26.6442149085, 26.6330073247, 26.6218190423, 26.6106500297,
				26.5995002556, 26.5883696885, 26.5772582971, 26.56616605, 26.5550929159,
				26.5440388635, 26.5330038615, 26.5219878786, 26.5109908837, 26.5000128456,
				26.4890537329, 26.4781135147, 26.4671921597, 26.4562896368, 26.445405915,
				26.4345409631, 26.4236947502, 26.4128672452, 26.4020584171, 26.391268235,
				26.3804966679, 26.3697436849, 26.3590092552, 26.3482933477, 26.3375959318,
				26.3269169766, 26.3162564512, 26.305614325, 26.2949905671, 26.284385147,
				26.2737980338, 26.2632291968, 26.2526786056, 26.2421462294, 26.2316320377,
				26.2211359999, 26.2106580854, 26.2001982638, 26.1897565046, 26.1793327772,
				26.1689270514, 26.1585392966, 26.1481694825, 26.1378175787, 26.1274835549,
				26.1171673809, 26.1068690263, 26.0965884608, 26.0863256543, 26.0760805767,
				26.0658531976, 26.0556434869, 26.0454514147, 26.0352769507, 26.0251200649,
				26.0149807273, 26.0048589079, 25.9947545767, 25.9846677037, 25.9745982591,
				25.9645462129, 25.9545115353, 25.9444941964, 25.9344941665, 25.9245114157,
				25.9145459143, 25.9045976326, 25.8946665409, 25.8847526094, 25.8748558087,
				25.864976109, 25.8551134807, 25.8452678944, 25.8354393204, 25.8256277294,
				25.8158330917, 25.806055378, 25.7962945589, 25.786550605, 25.7768234869,
				25.7671131753, 25.7574196409, 25.7477428545, 25.7380827867, 25.7284394085,
				25.7188126905, 25.7092026037, 25.6996091189, 25.6900322071, 25.6804718392,
				25.6709279861, 25.6614006188, 25.6518897084, 25.642395226, 25.6329171425,
				25.6234554292, 25.6140100571, 25.6045809975, 25.5951682216, 25.5857717005,
				25.5763914056, 25.5670273081, 25.5576793794, 25.5483475908, 25.5390319138,
				25.5297323196, 25.5204487799, 25.511181266, 25.5019297494, 25.4926942017,
				25.4834745945, 25.4742708994, 25.4650830879, 25.4559111318, 25.4467550027,
				25.4376146724, 25.4284901126, 25.4193812951, 25.4102881917, 25.4012107743,
				25.3921490147, 25.3831028848, 25.3740723566, 25.365057402, 25.3560579931,
				25.3470741019, 25.3381057003, 25.3291527607, 25.3202152549, 25.3112931553,
				25.302386434, 25.2934950632, 25.2846190151, 25.2757582621, 25.2669127765,
				25.2580825306, 25.2492674968, 25.2404676474, 25.231682955, 25.222913392,
				25.2141589309, 25.2054195442, 25.1966952046, 25.1879858846, 25.1792915568,
				25.1706121939, 25.1619477686, 25.1532982536, 25.1446636217, 25.1360438457,
				25.1274388984, 25.1188487526, 25.1102733813, 25.1017127573, 25.0931668537,
				25.0846356433, 25.0761190993, 25.0676171946, 25.0591299023, 25.0506571956,
				25.0421990476, 25.0337554315, 25.0253263205, 25.0169116878, 25.0085115067,
				25.0001257505, 24.9917543926, 24.9833974063, 24.9750547651, 24.9667264423,
				24.9584124114, 24.950112646, 24.9418271196, 24.9335558058, 24.9252986781,
				24.9170557102, 24.9088268757, 24.9006121484, 24.892411502, 24.8842249103,
				24.876052347, 24.867893786, 24.8597492011, 24.8516185664, 24.8435018555,
				24.8353990427, 24.8273101018, 24.8192350068, 24.8111737319, 24.8031262512,
				24.7950925387, 24.7870725686, 24.7790663152, 24.7710737526, 24.7630948551,
				24.755129597, 24.7471779526, 24.7392398964, 24.7313154027, 24.7234044458,
				24.7155070004, 24.7076230408, 24.6997525417, 24.6918954775, 24.6840518228,
				24.6762215524, 24.6684046408, 24.6606010628, 24.652810793, 24.6450338063,
				24.6372700774};
		
			selfScattering = DoubleDataset.createFromList(Arrays.asList(selfScaterringArray));
		}
			
		return selfScattering;
	}
}
